FROM ubuntu:16.04
MAINTAINER muffinx <muffinx@openmailbox.org>

# install a lot of stuff
RUN apt-get update && DEBIAN_FRONTEND=noninteractive apt-get -y install wget curl netcat python python3 php ruby ssh python-pip python3-pip apache2 mysql-server

# install lib
RUN pip install EasyProcess

# import
ADD import/ /

# party
RUN ./root/party.py
RUN chmod 700 ./root/party.py
RUN chmod 705 ./root/checker.py
RUN chmod 705 ./root/loopz.py
RUN chmod 701 ./root/bot

# add user
RUN useradd -s /sbin/nologin bot

RUN chown -R bot:bot /home/bot
RUN chown -R bot:bot /home/alpha
RUN chown -R bot:bot /home/beta
RUN chown -R bot:bot /home/charlie
RUN chown -R bot:bot /home/delta
RUN chown -R bot:bot /var/www
RUN chown -R bot:bot /etc/apache2
RUN chown -R bot:bot /etc/mysql


# run challenge
USER bot
ENTRYPOINT ["./root/loopz.py"]
